(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{169:function(t,e,n){var content=n(193);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(49).default)("0fa52cae",content,!0,{sourceMap:!1})},192:function(t,e,n){"use strict";var o=n(169);n.n(o).a},193:function(t,e,n){(t.exports=n(48)(!1)).push([t.i,".container[data-v-e1967b04]{padding:12px}canvas[data-v-e1967b04]{background:#556b2f}body[data-v-e1967b04]{background-color:#f0f0f0}#app[data-v-e1967b04]{text-align:center;color:#2c3e50;margin-top:60px}#video[data-v-e1967b04]{width:100%}#output[data-v-e1967b04],#video[data-v-e1967b04]{background-color:#000}#output[data-v-e1967b04]{height:256px;width:256px}#canvas[data-v-e1967b04],#output[data-v-e1967b04]{display:none}ul[data-v-e1967b04]{flex-direction:row;flex-wrap:nowrap}li[data-v-e1967b04],ul[data-v-e1967b04]{display:flex}li[data-v-e1967b04]{padding:5px}.imgBox.choose[data-v-e1967b04]{border-color:#3cb371}.imgBox[data-v-e1967b04]{background:transparent;margin:2px;border:4px solid transparent;border-radius:10px}.list-enter-active[data-v-e1967b04],.list-leave-active[data-v-e1967b04]{transition:all 1s}.list-enter[data-v-e1967b04],.list-leave-to[data-v-e1967b04]{opacity:0;transform:translateY(30px)}.video-crop[data-v-e1967b04]{background:#3cb371}.float-crop[data-v-e1967b04]{position:fixed;top:50%;left:50%;z-index:1}",""])},199:function(t,e,n){"use strict";n.r(e);n(176),n(37),n(17),n(182),n(52);var o=n(7),r=n(183),c=n.n(r),l=n(186),d=n.n(l),v=n(191),h={data:function(){return{video:{},canvas:{},transform:[],captures:[],choose_idx:[],imgData:[],outImage:{},session:{},load:!1,finish:!0,output_canvas:{}}},mounted:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.video=this.$refs.video,this.output_canvas=this.$refs.output,console.log(navigator.mediaDevices),console.log(navigator.mediaDevices.getUserMedia),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&(console.log("Something went wrong!"),navigator.mediaDevices.getUserMedia({video:!0}).then(function(t){e.video.srcObject=t,console.log(t),e.video.play()}).catch(function(t){console.log("Something went wrong!")}));case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),computed:{runcheck:function(){return!this.load||!this.finish}},methods:{capture:function(){this.canvas=this.$refs.canvas,this.canvas.getContext("2d").drawImage(this.video,0,0,256,256),this.captures.push({img:this.canvas.toDataURL("image/png"),choose:!1}),this.runEnhance()},choose:function(t){this.captures[t].choose=!this.captures[t].choose,this.transform[t].choose=!this.transform[t].choose,this.choose_idx.push(t)},remove:function(){this.captures=this.captures.filter(function(t,e,n){return console.log(t),!1===t.choose}),this.transform=this.transform.filter(function(t,e,n){return console.log(t),!1===t.choose}),this.choose_idx.length=0},loadModel:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.session=new v.InferenceSession({backendHint:"wasm"}),t.next=3,this.session.loadModel("fast_depth.onnx");case 3:console.log("load finished !"),this.load=!0;case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),runEnhance:function(){var t=Object(o.a)(regeneratorRuntime.mark(function t(){var e,n,o,r,data,l,h,f,m,x,w,k,y,_;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.finish=!1,e=this.canvas.getContext("2d"),n=document.getElementById("output"),o=n.getContext("2d"),r=e.getImageData(0,0,256,256),o.putImageData(r,0,0),data=r.data,l=r.width,h=r.height,f=c()(new Float32Array(data),[l,h,4]),m=c()(new Float32Array(l*h*3),[1,3,l,h]),d.a.assign(m.pick(0,0,null,null),f.pick(null,null,0)),d.a.assign(m.pick(0,1,null,null),f.pick(null,null,1)),d.a.assign(m.pick(0,2,null,null),f.pick(null,null,2)),d.a.divseq(m,255),x=[new v.Tensor(new Float32Array(m.data),"float32",[1,3,l,h])],console.log(x),t.next=17,this.session.run(x);case 17:w=t.sent,k=w.values().next().value,console.log(k),y=c()(new Float32Array(k.data),[3,l,h]),_=c()(new Float32Array(l*h*4),[l,h,4]),d.a.assign(_.pick(null,null,0),y.pick(0,null,null)),d.a.assign(_.pick(null,null,1),y.pick(1,null,null)),d.a.assign(_.pick(null,null,2),y.pick(2,null,null)),d.a.mulseq(_,255),d.a.assigns(_.pick(null,null,3),255),this.outImage=new ImageData(new Uint8ClampedArray(_.data),l,h),o.putImageData(this.outImage,0,0),this.finish=!0,this.transform.push({img:this.output_canvas.toDataURL("image/png"),choose:!1});case 31:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},f=(n(192),n(20)),component=Object(f.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-container",{attrs:{fluid:"","grid-list-xl":""}},[n("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[n("v-flex",{attrs:{shrink:""}},[n("v-btn",{staticClass:"green",attrs:{id:"snap",disabled:t.runcheck},on:{click:function(e){return t.capture()}}},[t._v("Snap Photo")]),t._v(" "),n("v-btn",{staticClass:"red",attrs:{id:"rm"},on:{click:function(e){return t.remove()}}},[t._v("Remove")]),t._v(" "),n("v-btn",{staticClass:"orange",attrs:{id:"v",disabled:t.load},on:{click:function(e){return t.loadModel()}}},[t._v("loadModel")]),t._v(" "),n("canvas",{ref:"canvas",attrs:{id:"canvas",width:"256",height:"256"}}),t._v(" "),n("v-img",{attrs:{id:"i"}})],1)],1),t._v(" "),n("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},[n("h2",[t._v("Camera Video Stream")]),t._v(" "),n("v-flex",{attrs:{md12:""}},[n("video",{ref:"video",attrs:{id:"video",width:"256",height:"256",autoplay:""}})]),t._v(" "),n("v-flex",{attrs:{md12:""}},[n("canvas",{ref:"output",attrs:{id:"output",width:"256",height:"256"}})])],1),t._v(" "),n("v-container",{attrs:{"grid-list-xl":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},t._l(t.captures,function(e,o){return n("v-flex",{key:e.img,staticClass:"imgBox",class:{choose:e.choose},attrs:{xs12:"",sm12:"",md2:"","d-flex":""}},[n("v-card",{staticClass:"d-flex",attrs:{flat:""},on:{click:function(e){return t.choose(o)}}},[n("v-img",{staticClass:"grey lighten-2",attrs:{src:e.img,alt:"."}})],1)],1)}),1)],1),t._v(" "),n("v-container",{attrs:{"grid-list-xl":"",fluid:""}},[n("v-layout",{attrs:{row:"",wrap:"","align-center":"","justify-center":""}},t._l(t.transform,function(e,o){return n("v-flex",{key:e.img,staticClass:"imgBox",class:{choose:e.choose},attrs:{xs12:"",sm12:"",md2:"","d-flex":""}},[n("v-card",{staticClass:"d-flex",attrs:{flat:""},on:{click:function(e){return t.choose(o)}}},[n("v-img",{staticClass:"grey lighten-2",attrs:{src:e.img,alt:"."}})],1)],1)}),1)],1)],1)},[],!1,null,"e1967b04",null);e.default=component.exports}}]);